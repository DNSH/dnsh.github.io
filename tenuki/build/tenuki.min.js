/*!
 * tenuki v0.2.1 (https://github.com/aprescott/tenuki.js)
 * Copyright Â© 2016 Adam Prescott.
 * Licensed under the MIT license.
 */
(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}e.tenuki=t()}})(function(){var t,e,r;return function n(t,e,r){function i(s,o){if(!e[s]){if(!t[s]){var u=typeof require=="function"&&require;if(!o&&u)return u(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var f=e[s]={exports:{}};t[s][0].call(f.exports,function(e){var r=t[s][1][e];return i(r?r:e)},f,f.exports,n,t,e,r)}return e[s].exports}var a=typeof require=="function"&&require;for(var s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,r){"use strict";r.Game=t("./lib/game").default;r.Client=t("./lib/client").default;r.utils=t("./lib/utils").default},{"./lib/client":3,"./lib/game":6,"./lib/utils":14}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var s=t[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){r.push(o.value);if(e&&r.length===e)break}}catch(u){i=true;a=u}finally{try{if(!n&&s["return"])s["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=f(i);var s=t("./intersection");var o=f(s);var u=t("./zobrist");var l=f(u);function f(t){return t&&t.__esModule?t:{"default":t}}var c=function d(t){var e=t.moveNumber;var r=t.playedPoint;var n=t.color;var i=t.pass;var a=t.blackPassStones;var s=t.whitePassStones;var o=t.intersections;var u=t.blackStonesCaptured;var f=t.whiteStonesCaptured;var c=t.capturedPositions;var d=t.koPoint;var h=t.boardSize;this.moveNumber=e;this.playedPoint=r;this.color=n;this.pass=i;this.blackPassStones=a;this.whitePassStones=s;this.intersections=o;this.blackStonesCaptured=u;this.whiteStonesCaptured=f;this.capturedPositions=c;this.koPoint=d;this.boardSize=h;this._positionHash=l.default.hash(h,o);Object.freeze(this)};c.prototype={_capturesFrom:function h(t,e,r){var n=this;var i=this.neighborsFor(t,e).filter(function(t){return!t.isEmpty()&&t.value!==r&&n.libertiesAt(t.y,t.x)===1});var s=a.default.flatMap(i,function(t){return n.groupAt(t.y,t.x)});return a.default.unique(s)},_updateIntersection:function v(t,e,r){return e.map(function(e){if(e.y===t.y&&e.x===t.x){return new o.default(e.y,e.x,r)}else{return e}})},_removeIntersection:function p(t,e){return this._updateIntersection(t,e,"empty")},_withoutIntersectionsMatching:function m(t){var e=this.intersections.map(function(e){if(t(e)){return new o.default(e.y,e.x,"empty")}else{return e}});return this._withNewPoints(e)},_withNewPoints:function y(t){var e=new c({moveNumber:this.moveNumber,playedPoint:this.playedPoint,color:this.color,pass:this.pass,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:t,blackStonesCaptured:this.blackStonesCaptured,whiteStonesCaptured:this.whiteStonesCaptured,capturedPositions:this.capturedPositions,koPoint:this.koPoint,boardSize:this.boardSize});return e},yCoordinateFor:function E(t){return this.boardSize-t},xCoordinateFor:function b(t){var e=["A","B","C","D","E","F","G","H","J","K","L","M","N","O","P","Q","R","S","T"];return e[t]},playPass:function S(t){var e={moveNumber:this.moveNumber+1,playedPoint:null,color:t,pass:true,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:this.intersections,blackStonesCaptured:this.blackStonesCaptured,whiteStonesCaptured:this.whiteStonesCaptured,capturedPositions:[],koPoint:null,boardSize:this.boardSize};e[t+"PassStones"]+=1;var r=new c(e);return r},playAt:function g(t,e,r){var n=this;var i=this._capturesFrom(t,e,r);var a=this.intersectionAt(t,e);var s=this.intersections;i.forEach(function(t){s=n._removeIntersection(t,s)});s=this._updateIntersection(a,s,r);var o=this.blackStonesCaptured+(r==="black"?0:i.length);var u=this.whiteStonesCaptured+(r==="white"?0:i.length);var l=this.boardSize;var f={moveNumber:this.moveNumber+1,playedPoint:a,color:r,pass:false,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:s,blackStonesCaptured:o,whiteStonesCaptured:u,capturedPositions:i,boardSize:l};var d=new c(f);var h=i.length===1&&d.groupAt(t,e).length===1&&d.inAtari(t,e);if(h){f["koPoint"]={y:i[0].y,x:i[0].x}}else{f["koPoint"]=null}return new c(f)},intersectionAt:function _(t,e){return this.intersections[t*this.boardSize+e]},groupAt:function w(t,e){var r=this.intersectionAt(t,e);var i=this.partitionTraverse(r,function(t){return t.sameColorAs(r)});var a=n(i,2);var s=a[0];var o=a[1];return s},libertiesAt:function I(t,e){var r=this;var n=this.intersectionAt(t,e);var i=a.default.flatMap(this.groupAt(n.y,n.x),function(t){return r.neighborsFor(t.y,t.x).filter(function(t){return t.isEmpty()})});return a.default.unique(i).length},inAtari:function A(t,e){return this.libertiesAt(t,e)===1},neighborsFor:function P(t,e){var r=[];if(e>0){r.push(this.intersectionAt(t,e-1))}if(e<this.boardSize-1){r.push(this.intersectionAt(t,e+1))}if(t>0){r.push(this.intersectionAt(t-1,e))}if(t<this.boardSize-1){r.push(this.intersectionAt(t+1,e))}return r},positionSameAs:function C(t){return this._positionHash===t._positionHash&&this.intersections.every(function(e){return e.sameColorAs(t.intersectionAt(e.y,e.x))})},partitionTraverse:function x(t,e){var r=[];var n=[];var i=[];i.push(t);while(i.length>0){var s=i.pop();if(r.indexOf(s)>-1){}else{r.push(s);this.neighborsFor(s.y,s.x).forEach(function(t){if(r.indexOf(t)>-1){}else{if(e(t)){i.push(t)}else{n.push(t)}}})}}return[r,a.default.unique(n)]}};c._initialFor=function(t,e){this._cache=this._cache||{};this._cache[t]=this._cache[t]||{};if(this._cache[t][e]){return this._cache[t][e]}var r=Array.apply(null,Array(t*t));r=r.map(function(e,r){return new o.default(Math.floor(r/t),r%t)});var n=t>11?3:2;var i={topRight:{y:n,x:t-n-1},bottomLeft:{y:t-n-1,x:n},bottomRight:{y:t-n-1,x:t-n-1},topLeft:{y:n,x:n},middle:{y:(t+1)/2-1,x:(t+1)/2-1},middleLeft:{y:(t+1)/2-1,x:n},middleRight:{y:(t+1)/2-1,x:t-n-1},middleTop:{y:n,x:(t+1)/2-1},middleBottom:{y:t-n-1,x:(t+1)/2-1}};var a={0:[],1:[],2:[i.topRight,i.bottomLeft],3:[i.topRight,i.bottomLeft,i.bottomRight],4:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft],5:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middle],6:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight],7:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middle],8:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middleTop,i.middleBottom],9:[i.topRight,i.bottomLeft,i.bottomRight,i.topLeft,i.middleLeft,i.middleRight,i.middleTop,i.middleBottom,i.middle]};a[e].forEach(function(e){r[e.y*t+e.x]=new o.default(e.y,e.x,"black")});var s=new c({color:e>1?"black":"white",moveNumber:0,intersections:Object.freeze(r),blackStonesCaptured:0,whiteStonesCaptured:0,whitePassStones:0,blackPassStones:0,boardSize:t});this._cache[t][e]=s;return s};r.default=c},{"./intersection":7,"./utils":14,"./zobrist":15}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./game");var i=a(n);function a(t){return t&&t.__esModule?t:{"default":t}}var s=function o(t){this._boardElement=t};s.prototype={setup:function u(t){var e=this;var r=t.player;var n=t.gameOptions;var a=t.hooks;this._player=r;this._hooks=a;if(this._player!=="black"&&this._player!=="white"){throw new Error("Player must be either black or white, but was given: "+this._player)}n["_hooks"]={handleClick:function s(t,r){if(e._busy){return}e._busy=true;if(e.isOver()){var n=e._game.currentState().groupAt(t,r).map(function(t){return{y:t.y,x:t.x,color:t.color}});e._hooks.submitMarkDeadAt(t,r,n,function(n){if(n){e._game.toggleDeadAt(t,r)}e._busy=false})}else{if(e._player!==e.currentPlayer()){e._busy=false;return}e._hooks.submitPlay(t,r,function(n){if(n){e._game.playAt(t,r,e._player)}e._busy=false})}},hoverValue:function o(t,r){if(!e._busy&&e._player===e.currentPlayer()&&!e.isOver()&&!e._game.isIllegalAt(t,r)){return e._player}},gameIsOver:function u(){return e.isOver()}};this._game=new i.default(this._boardElement);this._game.setup(n)},isOver:function l(){return this._game.isOver()},currentPlayer:function f(){return this._game.currentPlayer()},receivePlay:function c(t,e){if(this._player===this.currentPlayer()){return}this._game.playAt(t,e)},moveNumber:function d(){return this._game.moveNumber()},receivePass:function h(){if(this._player===this.currentPlayer()){return}this._game.pass()},receiveMarkDeadAt:function v(t,e){this._game.toggleDeadAt(t,e)},deadStones:function p(){return this._game.deadStones()},setDeadStones:function m(t){this._game._deadPoints=t.map(function(t){return{y:t.y,x:t.x}});this._game.render()},pass:function y(){var t=this;if(this._busy||this._player!==this.currentPlayer()){return}this._busy=true;this._hooks.submitPass(function(e){if(e){t._game.pass()}t._busy=false})}};r.default=s},{"./game":6}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=o(n);var a=t("./renderer");var s=o(a);function o(t){return t&&t.__esModule?t:{"default":t}}var u=function l(t,e){var r=e.hooks;var n=e.options;s.default.call(this,t,{hooks:r,options:n});if(this.smallerStones){i.default.addClass(t,"tenuki-smaller-stones")}i.default.addClass(t,"tenuki-dom-renderer")};u.prototype=Object.create(s.default.prototype);u.prototype.constructor=u;u.prototype._setup=function(t){s.default.prototype._setup.call(this,t);this.BOARD_LENGTH+=1;this.computeSizing()};u.prototype.generateBoard=function(t){var e=this;var r=this.boardElement;var n=e.zoomContainer;i.default.appendElement(n,i.default.createElement("div",{"class":"lines horizontal"}));i.default.appendElement(n,i.default.createElement("div",{"class":"lines vertical"}));i.default.appendElement(n,i.default.createElement("div",{"class":"hoshi-points"}));i.default.appendElement(n,i.default.createElement("div",{"class":"intersections"}));s.default.hoshiPositionsFor(t.boardSize).forEach(function(t){var n=i.default.createElement("div",{"class":"hoshi"});n.style.left=t.left*(e.INTERSECTION_GAP_SIZE+1)+"px";n.style.top=t.top*(e.INTERSECTION_GAP_SIZE+1)+"px";i.default.appendElement(r.querySelector(".hoshi-points"),n)});for(var a=0;a<t.boardSize;a++){var o=i.default.createElement("div",{"class":"line horizontal"});o.setAttribute("data-left-gutter",t.yCoordinateFor(a));i.default.appendElement(r.querySelector(".lines.horizontal"),o);var u=i.default.createElement("div",{"class":"line vertical"});u.setAttribute("data-top-gutter",t.xCoordinateFor(a));i.default.appendElement(r.querySelector(".lines.vertical"),u);for(var l=0;l<t.boardSize;l++){var f=i.default.createElement("div",{"class":"intersection empty"});var c=i.default.createElement("div",{"class":"stone"});i.default.appendElement(f,c);f.setAttribute("data-position-x",l);f.setAttribute("data-position-y",a);f.style.left=l*(e.INTERSECTION_GAP_SIZE+1)+"px";f.style.top=a*(e.INTERSECTION_GAP_SIZE+1)+"px";i.default.appendElement(r.querySelector(".intersections"),f);e.grid[a]=e.grid[a]||[];e.grid[a][l]=f;this.addIntersectionEventListeners(f,a,l)}}i.default.addEventListener(r.querySelector(".lines.horizontal"),"mousedown",function(t){t.preventDefault()});i.default.addEventListener(r.querySelector(".lines.vertical"),"mousedown",function(t){t.preventDefault()});r.querySelector(".lines.horizontal").style.width=e.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.horizontal").style.height=e.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.vertical").style.width=e.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";r.querySelector(".lines.vertical").style.height=e.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px"};u.prototype.setIntersectionClasses=function(t,e,r){if(t.className!==r.join(" ")){t.className=r.join(" ")}};r.default=u},{"./renderer":10,"./utils":14}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function i(t,e){this.boardState=t;this.intersection=e;Object.freeze(this)};n.prototype={diagonals:function a(){var t=this;var a=[];var e=[];var r=[];if(this.intersection.x>0){e.push(this.intersection.x-1)}if(this.intersection.x<this.boardState.boardSize-1){e.push(this.intersection.x+1)}if(this.intersection.y>0){r.push(this.intersection.y-1)}if(this.intersection.y<this.boardState.boardSize-1){r.push(this.intersection.y+1)}e.forEach(function(e){r.forEach(function(r){a.push(t.boardState.intersectionAt(r,e))})});return a},isFalse:function s(){if(!this.intersection.isEmpty()){return false}var t=this.diagonals();var e=t.length<=2;var r=this.neighbors();var n=r.filter(function(t){return!t.isEmpty()});if(e&&n.length<1){return false}if(!e&&n.length<2){return false}var i=t.filter(function(t){return!t.isEmpty()&&!t.sameColorAs(n[0])});if(e){return i.length>=1}else{return i.length>=2}},neighbors:function o(){return this.boardState.neighborsFor(this.intersection.y,this.intersection.x)},filledColor:function u(){if(!this.isFalse()){throw new Error("Attempting to find filled color for a non-false eye")}return this.neighbors()[0].value}};r.default=n},{}],6:[function(t,e,r){"use strict";var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol?"symbol":typeof t};Object.defineProperty(r,"__esModule",{value:true});var i=typeof Symbol==="function"&&n(Symbol.iterator)==="symbol"?function(t){return typeof t==="undefined"?"undefined":n(t)}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol?"symbol":typeof t==="undefined"?"undefined":n(t)};var a=t("./dom-renderer");var s=y(a);var o=t("./svg-renderer");var u=y(o);var l=t("./null-renderer");var f=y(l);var c=t("./board-state");var d=y(c);var h=t("./ruleset");var v=y(h);var p=t("./scorer");var m=y(p);function y(t){return t&&t.__esModule?t:{"default":t}}var E=["boardSize","scoring","handicapStones","koRule","komi","_hooks","fuzzyStonePlacement","renderer","freeHandicapPlacement"];var b=function S(t){this._defaultBoardSize=19;this.boardSize=null;this._moves=[];this.callbacks={postRender:function e(){}};this._boardElement=t;this._defaultScoring="territory";this._defaultKoRule="simple";this._defaultRenderer="svg";this._deadPoints=[]};b.prototype={_configureOptions:function g(){var t=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var e=t.boardSize;var r=e===undefined?this._defaultBoardSize:e;var n=t.komi;var a=n===undefined?0:n;var o=t.handicapStones;var l=o===undefined?0:o;var f=t.freeHandicapPlacement;var c=f===undefined?false:f;var h=t.scoring;var p=h===undefined?this._defaultScoring:h;var y=t.koRule;var E=y===undefined?this._defaultKoRule:y;var b=t.renderer;var S=b===undefined?this._defaultRenderer:b;if(typeof r!=="number"){throw new Error("Board size must be a number, but was: "+(typeof r==="undefined"?"undefined":i(r)))}if(typeof l!=="number"){throw new Error("Handicap stones must be a number, but was: "+(typeof r==="undefined"?"undefined":i(r)))}if(l>0&&r!==9&&r!==13&&r!==19){throw new Error("Handicap stones not supported on sizes other than 9x9, 13x13 and 19x19")}if(l<0||l===1||l>9){throw new Error("Only 2 to 9 handicap stones are supported")}if(r>19){throw new Error("cannot generate a board size greater than 19")}this.boardSize=r;this.handicapStones=l;this._freeHandicapPlacement=c;this._scorer=new m.default({scoreBy:p,komi:a});this._rendererChoice={dom:s.default,svg:u.default}[S];if(!this._rendererChoice){throw new Error("Unknown renderer: "+S)}this._whiteMustPassLast=this._scorer.usingPassStones();this._ruleset=new v.default({koRule:E});if(this._freeHandicapPlacement){this._initialState=d.default._initialFor(r,0)}else{this._initialState=d.default._initialFor(r,l)}},_stillPlayingHandicapStones:function _(){return this._freeHandicapPlacement&&this.handicapStones>0&&this._moves.length<this.handicapStones},setup:function w(){var t=this;var e=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];for(var r in e){if(e.hasOwnProperty(r)&&E.indexOf(r)<0){throw new Error("Unrecognized game option: "+r)}}this._configureOptions(e);if(this._boardElement){var n={handleClick:function i(e,r){if(t.isOver()){t.toggleDeadAt(e,r)}else{t.playAt(e,r)}},hoverValue:function a(e,r){if(!t.isOver()&&!t.isIllegalAt(e,r)){return t.currentPlayer()}},gameIsOver:function s(){return t.isOver()}};this.renderer=new this._rendererChoice(this._boardElement,{hooks:e["_hooks"]||n,options:{fuzzyStonePlacement:e["fuzzyStonePlacement"]}})}else{this.renderer=new f.default}this.render()},intersectionAt:function I(t,e){return this.currentState().intersectionAt(t,e)},intersections:function A(){return this.currentState().intersections},deadStones:function P(){return this._deadPoints},coordinatesFor:function C(t,e){return this.currentState().xCoordinateFor(e)+this.currentState().yCoordinateFor(t)},currentPlayer:function x(){if(this._stillPlayingHandicapStones()){return"black"}var t=this.currentState().color;if(t==="black"){return"white"}else{return"black"}},isWhitePlaying:function k(){return this.currentPlayer()==="white"},isBlackPlaying:function T(){return this.currentPlayer()==="black"},score:function N(){return this._scorer.score(this)},currentState:function O(){return this._moves[this._moves.length-1]||this._initialState},moveNumber:function R(){return this.currentState().moveNumber},playAt:function z(t,e){if(this.isIllegalAt(t,e)){return false}var r=this.currentState().playAt(t,e,this.currentPlayer());this._moves.push(r);this.render();return true},pass:function G(){if(this.isOver()){return false}var t=this.currentState().playPass(this.currentPlayer());this._moves.push(t);this.render();return true},isOver:function M(){if(this._moves.length<2){return false}if(this._whiteMustPassLast){var t=this._moves[this._moves.length-1];var e=this._moves[this._moves.length-2];return t.pass&&e.pass&&t.color==="white"}else{var r=this._moves[this._moves.length-1];var n=this._moves[this._moves.length-2];return r.pass&&n.pass}},toggleDeadAt:function L(t,e){var r=this;if(this.intersectionAt(t,e).isEmpty()){return}var n=this._isDeadAt(t,e);this.currentState().groupAt(t,e).forEach(function(t){if(n){r._deadPoints=r._deadPoints.filter(function(e){return!(e.y===t.y&&e.x===t.x)})}else{r._deadPoints.push({y:t.y,x:t.x})}});this.render();return true},_isDeadAt:function F(t,e){return this._deadPoints.some(function(r){return r.y===t&&r.x===e})},isIllegalAt:function D(t,e){return this._ruleset.isIllegal(t,e,this)},territory:function Z(){if(!this.isOver()){return{black:[],white:[]}}return this._scorer.territory(this)},undo:function B(){this._moves.pop();this.render()},render:function H(){if(!this.isOver()){this._deadPoints=[]}this.renderer.render(this.currentState(),{territory:this.territory(),deadStones:this.deadStones()});this.callbacks.postRender(this)}};r.default=b},{"./board-state":2,"./dom-renderer":4,"./null-renderer":8,"./ruleset":11,"./scorer":12,"./svg-renderer":13}],7:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function i(t,e,r){this.y=t;this.x=e;this.value=r||"empty";Object.freeze(this)};n.prototype={isOccupiedWith:function a(t){if(this.isEmpty()){return false}return this.value===t},isBlack:function s(){return this.value==="black"},isWhite:function o(){return this.value==="white"},isEmpty:function u(){return this.value==="empty"},sameColorAs:function l(t){return this.value===t.value}};r.default=n},{}],8:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.default=n;function n(){this.setup=function(){};this.render=function(){};this.renderTerritory=function(){}}},{}],9:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var s=t[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){r.push(o.value);if(e&&r.length===e)break}}catch(u){i=true;a=u}finally{try{if(!n&&s["return"])s["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=s(i);function s(t){return t&&t.__esModule?t:{"default":t}}var o=function u(t,e){this.boardState=t;this.intersections=e;Object.freeze(this)};o._startingAt=function(t,e,r){var i=t.intersectionAt(e,r);var a=t.partitionTraverse(i,function(t){return t.sameColorAs(i)});var s=n(a,2);var o=s[0];var u=s[1];return[o,u]};o.allFor=function(t){var e=[];var r=[];t.intersections.forEach(function(i){if(e.indexOf(i)>-1){}else{var a=t.partitionTraverse(i,function(t){return t.sameColorAs(i)});var s=n(a,2);var u=s[0];var l=s[1];r.push(new o(t,u));e=e.concat(u)}});return r};o.merge=function(t,e){var r=[e];var n=-1;while(r.length!==n){n=r.length;r=t.filter(function(t){return t.isEmpty()&&t.isTerritory()&&t.territoryColor()===e.territoryColor()&&t.expandedBoundaryStones().some(function(t){return r.some(function(e){return e.expandedBoundaryStones().indexOf(t)>-1})})})}return r};o.prototype={isEmpty:function l(){return this.intersections[0].isEmpty()},isTerritory:function f(){var t=this.intersections[0];if(!t.isEmpty()){return false}var e=o._startingAt(this.boardState,t.y,t.x);var r=n(e,2);var i=r[0];var s=r[1];var u=a.default.unique(s.map(function(t){return t.value}));var f=u.length===1&&u[0]!=="empty";return f},territoryColor:function c(){var t=this.intersections[0];var e=o._startingAt(this.boardState,t.y,t.x);var r=n(e,2);var i=r[0];var s=r[1];var u=a.default.unique(s.map(function(t){return t.value}));var l=u.length===1&&u[0]!=="empty";if(!t.isEmpty()||!l){throw new Error("Attempted to obtain territory color for something that isn't territory, region containing "+t.y+","+t.x)}else{return u[0]}},isBlack:function d(){return this.territoryColor()==="black"},isWhite:function h(){return this.territoryColor()==="white"},isNeutral:function v(){return!this.intersections[0].isBlack()&&!this.intersections[0].isWhite()&&!this.isTerritory()},exterior:function p(){var t=this;return this.boardState.intersections.filter(function(e){return t.intersections.indexOf(e)<0&&t.boardState.neighborsFor(e.y,e.x).some(function(e){return t.intersections.indexOf(e)>-1})})},boundaryStones:function m(){var t=this;if(!this.isEmpty()){throw new Error("Attempted to obtain boundary stones for non-empty region")}return this.exterior().filter(function(e){return!e.sameColorAs(t.intersections[0])})},expandedBoundaryStones:function y(){var t=this.boundaryStones();var e=o.allFor(this.boardState).filter(function(e){return e.intersections.some(function(e){return t.indexOf(e)>-1})});return a.default.flatMap(e,function(t){return t.intersections})},lengthOfTerritoryBoundary:function E(){var t=this;var e=this.intersections.filter(function(e){return e.y===0||e.y===t.boardState.boardSize-1||e.x===0||e.x===t.boardState.boardSize-1});var r=this.intersections.filter(function(e){return e.y%t.boardState.boardSize-1===0&&e.x%t.boardState.boardSize-1===0});return this.boundaryStones().length+e.length+r.length},containsSquareFour:function b(){var t=this;return this.intersections.some(function(e){return[[0,0],[0,1],[1,0],[1,1]].every(function(r){var i=n(r,2);var a=i[0];var s=i[1];var o=t.boardState.intersectionAt(e.y+a,e.x+s);return typeof o!=="undefined"&&o.sameColorAs(e)})})},containsCurvedFour:function S(){var t=this;return this.intersections.some(function(e){return[[[0,0],[1,0],[2,0],[2,1]],[[-1,2],[0,0],[0,1],[0,2]],[[0,0],[0,1],[1,1],[2,1]],[[-1,0],[-1,1],[-1,2],[0,0]],[[-2,1],[-1,1],[0,0],[0,1]],[[0,0],[1,0],[1,1],[1,2]],[[0,-1],[0,0],[1,-1],[2,-1]],[[-1,-2],[-1,-1],[-1,0],[0,0]]].some(function(r){return r.every(function(r){var i=n(r,2);var a=i[0];var s=i[1];var o=t.boardState.intersectionAt(e.y+a,e.x+s);return typeof o!=="undefined"&&o.sameColorAs(e)})})})},numberOfEyes:function g(){if(!this.intersections[0].isEmpty()){throw new Error("Unexpected calculation of number of eyes for a non-empty region containing "+this.intersections[0].y+","+this.intersections[0].x)}var t=this.lengthOfTerritoryBoundary();if(t<2){throw new Error("Unexpected boundary length of "+t+" for region including "+this.intersections[0].y+","+this.intersections[0].x)}if(t>=10){return 2}var e=void 0;switch(t){case 2:case 3:case 4:case 5:case 6:e=1;break;case 7:e=1.5;break;case 8:if(this.containsSquareFour()){e=1}else if(this.containsCurvedFour()){e=2}else{e=1.5}break;case 9:if(this.containsSquareFour()){e=1.5}else{e=2}break;default:throw new Error("unhandled boundary length "+t)}return e}};r.default=o},{"./utils":14}],10:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var i=false;var a=undefined;try{for(var s=t[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){r.push(o.value);if(e&&r.length===e)break}}catch(u){i=true;a=u}finally{try{if(!n&&s["return"])s["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=t("./utils");var a=s(i);function s(t){return t&&t.__esModule?t:{"default":t}}var o=function u(t,e){var r=e.hooks;var n=e.options;this.INTERSECTION_GAP_SIZE=28;this.GUTTER_MARGIN=this.INTERSECTION_GAP_SIZE-3;this.BASE_MARGIN=this.INTERSECTION_GAP_SIZE-10;this.hasCoordinates=t.hasAttribute("data-include-coordinates");this.MARGIN=this.hasCoordinates?this.BASE_MARGIN+this.GUTTER_MARGIN:this.BASE_MARGIN;this.boardElement=t;this.grid=[];this.hooks=r||{};this._options=n||{};this._initialized=false;if(this._options["fuzzyStonePlacement"]){a.default.addClass(t,"tenuki-fuzzy-placement");a.default.addClass(t,"tenuki-board-textured");this.smallerStones=true}if(a.default.hasClass(t,"tenuki-board-textured")){this.texturedStones=true}};o.hoshiPositionsFor=function(t){var e=[];if(t<7){if(t>1&&t%2===1){var r={};r.top=(t-1)/2;r.left=r.top;e.push(r)}else{}}else{var n=t>11?3:2;for(var i=0;i<3;i++){for(var a=0;a<3;a++){if((t===7||t%2===0)&&(i===1||a===1)){continue}var s={};if(i===0){s.top=n}if(i===1){s.top=(t+1)/2-1}if(i===2){s.top=t-n-1}if(a===0){s.left=n}if(a===1){s.left=(t+1)/2-1}if(a===2){s.left=t-n-1}e.push(s)}}}return e};o.prototype={_setup:function l(t){var e=this;var r=this.boardElement;e.BOARD_LENGTH=2*this.MARGIN+(t.boardSize-1)*(this.INTERSECTION_GAP_SIZE+1);var n=a.default.createElement("div",{"class":"tenuki-inner-container"});e.innerContainer=n;a.default.appendElement(r,n);var i=a.default.createElement("div",{"class":"tenuki-zoom-container"});e.zoomContainer=i;a.default.appendElement(n,i);e.cancelZoomElement=a.default.createElement("div",{"class":"cancel-zoom"});var s=a.default.createElement("div",{"class":"cancel-zoom-backdrop"});a.default.addEventListener(e.cancelZoomElement,"click",function(t){t.preventDefault();e.zoomOut();return false});a.default.addEventListener(s,"click",function(t){t.preventDefault();e.zoomOut();return false});a.default.appendElement(n,e.cancelZoomElement);a.default.appendElement(n,s);var o=function u(t,e){var r=false;var n=function i(){if(r){return}r=true;window.requestAnimationFrame(function(){window.dispatchEvent(new CustomEvent(e));r=false})};window.addEventListener(t,n)};o("resize","optimizedResize");this.generateBoard(t);e.computeSizing();window.addEventListener("optimizedResize",function(){e.computeSizing()});e.touchmoveChangedTouch=null;e.touchstartEventHandler=e.handleTouchStart.bind(e);e.touchmoveEventHandler=e.handleTouchMove.bind(e);e.touchendEventHandler=e.handleTouchEnd.bind(e);a.default.addEventListener(r,"touchstart",e.touchstartEventHandler);a.default.addEventListener(r,"touchend",e.touchendEventHandler);a.default.addEventListener(r,"touchmove",e.touchmoveEventHandler)},computeSizing:function f(){var t=this;var e=this.innerContainer;var r=this.zoomContainer;var n=this.boardElement;e.style.height="";e.style.width="";r.style.height="";r.style.width="";e.style.transform="";n.style.width="";n.style.height="";t._touchEventFired=null;e.style.width=t.BOARD_LENGTH+"px";e.style.height=t.BOARD_LENGTH+"px";r.style.width=t.BOARD_LENGTH+"px";r.style.height=t.BOARD_LENGTH+"px";var i=e.parentNode.clientWidth/e.clientWidth;var s=e.parentNode.clientHeight/e.clientHeight;var o=Math.min(i,s);if(o>0&&o<1){a.default.addClass(n,"tenuki-scaled");e.style["transform-origin"]="top left";e.style.transform="scale3d("+o+", "+o+", 1)";r.style.willChange="transform"}n.style.width=e.getBoundingClientRect().width+"px";n.style.height=e.getBoundingClientRect().height+"px"},addIntersectionEventListeners:function c(t,e,r){var n=this;a.default.addEventListener(t,"mouseenter",function(){var i=e;var s=r;var o=n.hooks.hoverValue(i,s);if(o){a.default.addClass(t,"hovered");a.default.addClass(t,o)}});a.default.addEventListener(t,"mouseleave",function(){if(a.default.hasClass(this,"hovered")){a.default.removeClass(t,"hovered");a.default.removeClass(t,"black");a.default.removeClass(t,"white")}n.resetTouchedPoint()});a.default.addEventListener(t,"click",function(){var i=e;var a=r;if(!n._touchEventFired||document.body.clientWidth/window.innerWidth>1||n.hooks.gameIsOver()){n.hooks.handleClick(i,a);return}if(n.touchedPoint){if(t===n.touchedPoint){n.hooks.handleClick(i,a)}else{n.showPossibleMoveAt(t,i,a)}}else{n.showPossibleMoveAt(t,i,a)}})},handleTouchStart:function d(t){var e=this;e._touchEventFired=true;if(t.touches.length>1){if(e.zoomedIn){t.preventDefault()}return}if(!e.zoomedIn){return}var r=t.changedTouches[0].clientX;var n=t.changedTouches[0].clientY;e.dragStartX=r;e.dragStartY=n;e.zoomContainer.style.transition="none";e.animationFrameRequestID=window.requestAnimationFrame(e.processDragDelta.bind(e))},handleTouchMove:function h(t){var e=this;if(t.touches.length>1){return}if(!e.zoomedIn){return true}t.preventDefault();e.touchmoveChangedTouch=t.changedTouches[0];e.moveInProgress=true},handleTouchEnd:function v(t){var e=this;if(t.touches.length>1){return}if(!e.zoomedIn){return}e.zoomContainer.style.transition="";if(!e.moveInProgress){return}e.translateY=e.lastTranslateY;e.translateX=e.lastTranslateX;e.moveInProgress=false;e.touchmoveChangedTouch=null;window.cancelAnimationFrame(e.animationFrameRequestID)},processDragDelta:function p(){var t=this;if(!t.touchmoveChangedTouch){t.animationFrameRequestID=window.requestAnimationFrame(t.processDragDelta.bind(t));return}var e=t.innerContainer;var r=t.touchmoveChangedTouch.clientX;var n=t.touchmoveChangedTouch.clientY;var i=r-t.dragStartX;var a=n-t.dragStartY;var s=t.translateY+a/2.5;var o=t.translateX+i/2.5;if(s>.5*e.clientHeight-t.MARGIN){s=.5*e.clientHeight-t.MARGIN}if(o>.5*e.clientWidth-t.MARGIN){o=.5*e.clientWidth-t.MARGIN}if(s<-.5*e.clientHeight+t.MARGIN){s=-.5*e.clientHeight+t.MARGIN}if(o<-.5*e.clientWidth+t.MARGIN){o=-.5*e.clientWidth+t.MARGIN}t.zoomContainer.style.transform="translate3d("+2.5*o+"px, "+2.5*s+"px, 0) scale3d(2.5, 2.5, 1)";t.lastTranslateX=o;t.lastTranslateY=s;t.animationFrameRequestID=window.requestAnimationFrame(t.processDragDelta.bind(t))},showPossibleMoveAt:function m(t,e,r){var n=this;var i=this.boardElement;var s=this.zoomContainer;n.zoomContainerHeight=n.zoomContainerHeight||s.clientHeight;n.zoomContainerWidth=n.zoomContainerWidth||s.clientWidth;n.touchedPoint=t;if(a.default.hasClass(i,"tenuki-scaled")){var o=e*(this.INTERSECTION_GAP_SIZE+1);var u=r*(this.INTERSECTION_GAP_SIZE+1);var l=.5*n.zoomContainerHeight-o-n.MARGIN;var f=.5*n.zoomContainerWidth-u-n.MARGIN;s.style.transform="translate3d("+2.5*f+"px, "+2.5*l+"px, 0) scale3d(2.5, 2.5, 1)";n.translateY=l;
n.translateX=f;a.default.addClass(n.cancelZoomElement,"visible");n.zoomedIn=true}},resetTouchedPoint:function y(){var t=this;t.touchedPoint=null},zoomOut:function E(){var t=this;this.resetTouchedPoint();t.zoomContainer.style.transform="";t.zoomContainer.style.transition="";t.dragStartX=null;t.dragStartY=null;t.translateY=null;t.translateX=null;t.lastTranslateX=null;t.lastTranslateY=null;a.default.removeClass(t.cancelZoomElement,"visible");t.zoomedIn=false},render:function b(t){var e=this;var r=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var i=r.territory;var s=r.deadStones;if(!this._initialized){this._setup(t);this._initialized=true}this.resetTouchedPoint();this.renderStonesPlayed(t.intersections);var o=t.playedPoint;this.updateMarkerPoints({playedPoint:o,koPoint:t.koPoint});if(this._options["fuzzyStonePlacement"]&&o){var u=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none"];var l=["h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];var f=u.concat(l);var c=f.some(function(t){return a.default.hasClass(e.grid[o.y][o.x],t)});if(!c){(function(){var t=a.default.cartesianProduct(u,l);var r=n(t[Math.floor(Math.random()*t.length)],2);var i=r[0];var s=r[1];[[-1,0],[0,-1],[0,1],[1,0]].forEach(function(t){var r=n(t,2);var u=r[0];var l=r[1];if(e.grid[o.y+u]&&e.grid[o.y+u][o.x+l]){(function(){var t=e.grid[o.y+u][o.x+l];if(!a.default.hasClass(t,"empty")){[[-1,0,"v-shift-downdown","v-shift-up","v-shift-down"],[-1,0,"v-shift-downdown","v-shift-upup","v-shift-none"],[-1,0,"v-shift-down","v-shift-upup","v-shift-none"],[1,0,"v-shift-upup","v-shift-down","v-shift-up"],[1,0,"v-shift-upup","v-shift-downdown","v-shift-none"],[1,0,"v-shift-up","v-shift-downdown","v-shift-none"],[0,-1,"h-shift-rightright","h-shift-left","h-shift-right"],[0,-1,"h-shift-rightright","h-shift-leftleft","h-shift-none"],[0,-1,"h-shift-right","h-shift-leftleft","h-shift-none"],[0,1,"h-shift-leftleft","h-shift-right","h-shift-left"],[0,1,"h-shift-leftleft","h-shift-rightright","h-shift-none"],[0,1,"h-shift-left","h-shift-rightright","h-shift-none"]].forEach(function(e){var r=n(e,5);var o=r[0];var f=r[1];var c=r[2];var d=r[3];var h=r[4];if(u===o&&l===f&&a.default.hasClass(t,c)&&(i===d||s===d)){a.default.removeClass(t,c);a.default.addClass(t,h)}})}})()}});a.default.addClass(e.grid[o.y][o.x],i);a.default.addClass(e.grid[o.y][o.x],s)})()}}if(i){this.renderTerritory(i,s)}},renderStonesPlayed:function S(t){var e=this;t.forEach(function(t){e.renderIntersection(t)})},updateMarkerPoints:function g(t){var e=t.playedPoint;var r=t.koPoint;var n=this;if(r){a.default.addClass(n.grid[r.y][r.x],"ko")}if(e){a.default.addClass(n.grid[e.y][e.x],"played")}},renderIntersection:function _(t){var e=this;var r=e.grid[t.y][t.x];var n=["intersection"];if(t.isEmpty()){n.push("empty")}else{n.push("occupied");if(t.isBlack()){n.push("black")}else{n.push("white")}var i=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none","h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];i.forEach(function(t){if(a.default.hasClass(r,t)){n.push(t)}})}this.setIntersectionClasses(r,t,n)},renderTerritory:function w(t,e){var r=this;a.default.flatten(this.grid).forEach(function(t){a.default.removeClass(t,"territory-black");a.default.removeClass(t,"territory-white");a.default.removeClass(t,"dead")});e.forEach(function(t){a.default.addClass(r.grid[t.y][t.x],"dead")});t.black.forEach(function(t){a.default.addClass(r.grid[t.y][t.x],"territory-black")});t.white.forEach(function(t){a.default.addClass(r.grid[t.y][t.x],"territory-white")})}};r.default=o},{"./utils":14}],11:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=["simple","superko"];var i=function a(t){var e=t.koRule;this.koRule=e;if(n.indexOf(this.koRule)<0){throw new Error("Unknown ko rule: "+e)}Object.freeze(this)};i.prototype={isIllegal:function s(t,e,r){var n=r.currentState();var i=r.currentPlayer();var a=n.intersectionAt(t,e);var s=!a.isEmpty()||this._wouldBeSuicide(t,e,i,n)||this._isKoViolation(t,e,i,n,r._moves);return s},_isKoViolation:function o(t,e,r,n,i){var a=false;if(this.koRule==="simple"){var s=n.koPoint;a=s&&s.y===t&&s.x===e}else{(function(){var s=n.playAt(t,e,r);var o=i;a=i.length>0&&o.some(function(t){return t.positionSameAs(s)})})()}return a},_wouldBeSuicide:function u(t,e,r,n){var i=n.intersectionAt(t,e);var a=i.isEmpty()&&n.neighborsFor(i.y,i.x).filter(function(t){return t.isEmpty()}).length===0;if(!a){return false}var s=n.neighborsFor(i.y,i.x).some(function(t){var e=n.inAtari(t.y,t.x);var i=t.isOccupiedWith(r);return i&&!e});if(s){return false}var o=n.neighborsFor(i.y,i.x).some(function(t){var e=n.inAtari(t.y,t.x);var i=!t.isOccupiedWith(r);return i&&e});if(o){return false}return true}};r.default=i},{}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=c(n);var a=t("./intersection");var s=c(a);var o=t("./region");var u=c(o);var l=t("./eye-point");var f=c(l);function c(t){return t&&t.__esModule?t:{"default":t}}var d=function E(t){return t.currentState()._withoutIntersectionsMatching(function(e){return t._isDeadAt(e.y,e.x)})};var h=function b(t){var e=u.default.allFor(t);var r=e.filter(function(t){return t.isNeutral()});if(e.length===0||r.length===0){return t}var n={};r.forEach(function(t){var e=null;var r=null;t.intersections.forEach(function(t){e=e||t.x;e=e||t.y;var i=Math.abs(t.y-r)+Math.abs(t.x-e);var a=["black","white"][i%2];var o=new s.default(t.y,t.x,a);n[t.y]=n[t.y]||[];n[t.y][t.x]=o})});var i=t.intersections.map(function(t){if(n[t.y]&&n[t.y][t.x]){return n[t.y][t.x]}else{return t}});return t._withNewPoints(i)};var v=function S(t){var e=u.default.allFor(t).filter(function(t){return t.isTerritory()});var r=i.default.flatMap(e,function(t){return t.intersections}).filter(function(e){return new f.default(t,e).isFalse()});var n=r.filter(function(e){return t.neighborsFor(e.y,e.x).some(function(e){return t.inAtari(e.y,e.x)})});var a=t;var o=function l(){var t=a.intersections.map(function(t){if(n.indexOf(t)>-1){return new s.default(t.y,t.x,new f.default(a,t).filledColor())}else{return t}});a=a._withNewPoints(t);var e=h(a);var r=u.default.allFor(e).filter(function(t){return t.isTerritory()});var o=i.default.flatMap(r,function(t){return t.intersections}).filter(function(t){return new f.default(e,t).isFalse()});n=o.filter(function(t){return a.neighborsFor(t.y,t.x).some(function(t){return a.inAtari(t.y,t.x)})})};while(n.length>0){o()}return a};var p=Object.freeze({score:function g(t){var e=t.deadStones().filter(function(e){return t.intersectionAt(e.y,e.x).isBlack()});var r=t.deadStones().filter(function(e){return t.intersectionAt(e.y,e.x).isWhite()});var n=t.territory();var i=t.currentState();return{black:n.black.length+i.whiteStonesCaptured+r.length,white:n.white.length+i.blackStonesCaptured+e.length}},territory:function _(t){var e=d(t);var r=h(e);var n=v(r);var a=u.default.allFor(n).filter(function(t){return t.isTerritory()});var s=a.filter(function(t){var e=u.default.merge(a,t);var r=e.map(function(t){return Math.ceil(t.numberOfEyes())});return r.length>0&&r.reduce(function(t,e){return t+e})>=2});var o=s.filter(function(t){return t.isBlack()});var l=s.filter(function(t){return t.isWhite()});return{black:i.default.flatMap(o,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}}),white:i.default.flatMap(l,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}})}}});var m=Object.freeze({score:function w(t){var e=t.intersections().filter(function(e){return e.isBlack()&&!t._isDeadAt(e.y,e.x)});var r=t.intersections().filter(function(e){return e.isWhite()&&!t._isDeadAt(e.y,e.x)});var n=t.territory();return{black:n.black.length+e.length,white:n.white.length+r.length}},territory:function I(t){var e=u.default.allFor(d(t));var r=e.filter(function(t){return t.isTerritory()});var n=r.filter(function(t){return t.isBlack()});var a=r.filter(function(t){return t.isWhite()});return{black:i.default.flatMap(n,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}}),white:i.default.flatMap(a,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}})}}});var y=function A(){var t=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var e=t.scoreBy;var r=t.komi;this._strategy={area:m,territory:p,equivalence:m}[e];this._komi=r;if(!this._strategy){throw new Error("Unknown scoring type: "+e)}if(this._komi===null||typeof this._komi==="undefined"){throw new Error("Error initializing scorer without a komi value")}if(typeof this._komi!=="number"){throw new Error("Komi value given is not a number: "+r)}this._usePassStones=e==="equivalence";Object.freeze(this)};y.prototype={score:function P(t){var e=this._strategy.score(t);e.white+=this._komi;if(this._usePassStones){return{black:e.black+t.currentState().whitePassStones,white:e.white+t.currentState().blackPassStones}}else{return e}},territory:function C(t){return this._strategy.territory(t)},usingPassStones:function x(){return this._usePassStones}};r.default=y},{"./eye-point":5,"./intersection":7,"./region":9,"./utils":14}],13:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=t("./utils");var i=o(n);var a=t("./renderer");var s=o(a);function o(t){return t&&t.__esModule?t:{"default":t}}var u=function l(t,e){var r=e.hooks;var n=e.options;s.default.call(this,t,{hooks:r,options:n});i.default.addClass(t,"tenuki-svg-renderer")};u.prototype=Object.create(s.default.prototype);u.prototype.constructor=u;u.prototype.generateBoard=function(t){var e=this;var r=this;var n=r.zoomContainer;var a=i.default.createSVGElement("svg");r.svgElement=a;var o=i.default.createSVGElement("defs");i.default.appendElement(a,o);r.blackGradientID=i.default.randomID("black-gradient");r.whiteGradientID=i.default.randomID("white-gradient");var u=i.default.createSVGElement("radialGradient",{attributes:{id:r.blackGradientID,cy:"0",r:"55%"}});i.default.appendElement(u,i.default.createSVGElement("stop",{attributes:{offset:"0%","stop-color":"#848484"}}));i.default.appendElement(u,i.default.createSVGElement("stop",{attributes:{offset:"100%","stop-color":"hsl(0, 0%, 20%)"}}));i.default.appendElement(o,u);var l=i.default.createSVGElement("radialGradient",{attributes:{id:r.whiteGradientID,cy:"0",r:"70%"}});i.default.appendElement(l,i.default.createSVGElement("stop",{attributes:{offset:"0%","stop-color":"white"}}));i.default.appendElement(l,i.default.createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#DDDDDD"}}));i.default.appendElement(o,l);var f=i.default.createSVGElement("g",{attributes:{"class":"contents",transform:"translate("+this.MARGIN+", "+this.MARGIN+")"}});var c=i.default.createSVGElement("g",{attributes:{"class":"lines"}});i.default.appendElement(f,c);for(var d=0;d<t.boardSize-1;d++){for(var h=0;h<t.boardSize-1;h++){var v=i.default.createSVGElement("rect",{attributes:{y:d*(this.INTERSECTION_GAP_SIZE+1)-.5,x:h*(this.INTERSECTION_GAP_SIZE+1)-.5,width:this.INTERSECTION_GAP_SIZE+1,height:this.INTERSECTION_GAP_SIZE+1,"class":"line-box"}});i.default.appendElement(c,v)}}var p=i.default.createSVGElement("g",{attributes:{"class":"hoshi"}});i.default.appendElement(f,p);s.default.hoshiPositionsFor(t.boardSize).forEach(function(t){var r=i.default.createSVGElement("circle",{attributes:{"class":"hoshi",cy:t.top*(e.INTERSECTION_GAP_SIZE+1)-.5,cx:t.left*(e.INTERSECTION_GAP_SIZE+1)-.5,r:2}});i.default.appendElement(p,r)});var m=i.default.createSVGElement("g",{attributes:{"class":"intersections"}});i.default.appendElement(f,m);if(this.hasCoordinates){(function(){var r=i.default.createSVGElement("g",{attributes:{"class":"coordinates",transform:"translate("+e.MARGIN+", "+e.MARGIN+")"}});var n=function o(n){if(e.hasCoordinates){[16/2+1-(16+16/2+16/(2*2)+16/(2*2*2)),16/2+1+(16+16/2)+(t.boardSize-1)*(e.INTERSECTION_GAP_SIZE+1)].forEach(function(a){i.default.appendElement(r,i.default.createSVGElement("text",{text:t.xCoordinateFor(n),attributes:{"text-anchor":"middle",y:a-.5,x:n*(e.INTERSECTION_GAP_SIZE+1)-.5}}))});[-1*(16+16/2+16/(2*2)),16+16/2+16/(2*2)+(t.boardSize-1)*(e.INTERSECTION_GAP_SIZE+1)].forEach(function(a){i.default.appendElement(r,i.default.createSVGElement("text",{text:t.yCoordinateFor(n),attributes:{"text-anchor":"middle",y:n*(e.INTERSECTION_GAP_SIZE+1)-.5+16/(2*2),x:a-.5}}))});i.default.appendElement(a,r)}};for(var s=0;s<t.boardSize;s++){n(s)}})()}for(var y=0;y<t.boardSize;y++){for(var E=0;E<t.boardSize;E++){var b=i.default.createSVGElement("g",{attributes:{"class":"intersection"}});i.default.appendElement(m,b);var S=i.default.createSVGElement("g",{attributes:{"class":"intersection-inner-container"}});i.default.appendElement(b,S);var g=i.default.createSVGElement("rect",{attributes:{y:y*(this.INTERSECTION_GAP_SIZE+1)-this.INTERSECTION_GAP_SIZE/2-.5,x:E*(this.INTERSECTION_GAP_SIZE+1)-this.INTERSECTION_GAP_SIZE/2-.5,width:this.INTERSECTION_GAP_SIZE,height:this.INTERSECTION_GAP_SIZE}});i.default.appendElement(S,g);var _=this.INTERSECTION_GAP_SIZE/2;if(this.smallerStones){_-=1}var w={"class":"stone",cy:y*(this.INTERSECTION_GAP_SIZE+1)-.5,cx:E*(this.INTERSECTION_GAP_SIZE+1)-.5,width:this.INTERSECTION_GAP_SIZE+1,height:this.INTERSECTION_GAP_SIZE+1,r:_};if(this.texturedStones){i.default.appendElement(S,i.default.createSVGElement("circle",{attributes:{"class":"stone-shadow",cy:w["cy"]+2,cx:w["cx"],width:w["width"],height:w["height"],r:_}}))}var I=i.default.createSVGElement("circle",{attributes:w});i.default.appendElement(S,I);i.default.appendElement(S,i.default.createSVGElement("circle",{attributes:{"class":"marker",cy:y*(this.INTERSECTION_GAP_SIZE+1)-.5,cx:E*(this.INTERSECTION_GAP_SIZE+1)-.5,width:this.INTERSECTION_GAP_SIZE+1,height:this.INTERSECTION_GAP_SIZE+1,r:4.5}}));i.default.appendElement(S,i.default.createSVGElement("rect",{attributes:{"class":"ko-marker",y:y*(this.INTERSECTION_GAP_SIZE+1)-6-.5,x:E*(this.INTERSECTION_GAP_SIZE+1)-6-.5,width:12,height:12}}));i.default.appendElement(S,i.default.createSVGElement("rect",{attributes:{"class":"territory-marker",y:y*(this.INTERSECTION_GAP_SIZE+1)-6,x:E*(this.INTERSECTION_GAP_SIZE+1)-6,width:11,height:11}}));this.grid[y]=this.grid[y]||[];this.grid[y][E]=b;this.addIntersectionEventListeners(b,y,E)}}i.default.appendElement(a,f);i.default.appendElement(n,a);r.svgElement.setAttribute("height",r.BOARD_LENGTH);r.svgElement.setAttribute("width",r.BOARD_LENGTH)};u.prototype.setIntersectionClasses=function(t,e,r){if(t.getAttribute("class")!==r.join(" ")){t.setAttribute("class",r.join(" "))}if(this.texturedStones){if(e.isEmpty()){t.querySelector(".stone").setAttribute("style","")}else{t.querySelector(".stone").setAttribute("style","fill: url(#"+this[e.value+"GradientID"]+")")}}};r.default=u},{"./renderer":10,"./utils":14}],14:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.default={flatten:function n(t){return t.reduce(function(t,e){return t.concat(e)})},flatMap:function i(t,e){return Array.prototype.concat.apply([],t.map(e))},cartesianProduct:function a(t,e){return this.flatten(t.map(function(t){return e.map(function(e){return[t,e]})}))},randomID:function s(t){var e=[0,1,2,3].map(function(){return Math.floor(Math.random()*65536).toString(16).substring(1)}).join("");return t+"-"+e},createElement:function o(t,e){var r=document.createElement(t);if(typeof e!=="undefined"){if(e.class){r.className=e.class}}return r},createSVGElement:function u(t,e){var r=this;var n="http://www.w3.org/2000/svg";var i=document.createElementNS(n,t);if(typeof e!=="undefined"){if(e.class){e.class.split(" ").forEach(function(t){r.addClass(i,t)})}if(e.attributes){Object.keys(e.attributes).forEach(function(t){i.setAttribute(t,e.attributes[t])})}if(e.text){i.textContent=e.text.toString()}}return i},appendElement:function l(t,e){t.insertBefore(e,null)},addEventListener:function f(t,e,r){t.addEventListener(e,r,false)},removeClass:function c(t,e){if(t.classList&&t.classList.remove){t.classList.remove(e);return}var r=RegExp("\\b"+e+"\\b","g");if(t instanceof SVGElement){t.setAttribute("class",t.getAttribute("class").replace(r,""))}else{t.className=t.getAttribute("class").replace(r,"")}},addClass:function d(t,e){if(t.classList&&t.classList.add){t.classList.add(e);return}if(t instanceof SVGElement){t.setAttribute("class",t.getAttribute("class")+" "+e)}else{t.className=t.getAttribute("class")+" "+e}},hasClass:function h(t,e){if(t.classList&&t.classList.contains){return t.classList.contains(e)}var r=RegExp("\\b"+e+"\\b","g");if(t instanceof SVGElement){return r.test(t.getAttribute("class"))}else{return r.test(t.className)}},toggleClass:function v(t,e){if(t.classList&&t.classList.toggle){t.classList.toggle(e);return}if(this.hasClass(t,e)){this.removeClass(t,e)}else{this.addClass(t,e)}},unique:function p(t){var p=[];t.forEach(function(t){if(p.indexOf(t)<0){p.push(t)}});return p}}},{}],15:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n={};function i(t,e,r,i){n[t]=n[t]||{};n[t][e]=n[t][e]||{};n[t][e][r]=n[t][e][r]||{};if(n[t][e][r][i]){return n[t][e][r][i]}var a=Math.floor(Math.random()*(Math.pow(2,31)-1));n[t][e][r][i]=a;return a}r.default={hash:function a(t,e){var r=0;e.forEach(function(e){if(!e.isEmpty()){var n=i(t,e.y,e.x,e.value);r=r^n}});return r}}},{}]},{},[1])(1)});
