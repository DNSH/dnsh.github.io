<!doctype html>
<meta charset="utf-8">

<link rel="stylesheet" href="build/tenuki.css"></link>
<script src="build/tenuki.js"></script>

<div id="test-board" class="tenuki-board"></div>

<script>
// phantomjs has no click().
// patch courtesy of http://stackoverflow.com/a/17789929/528044
if (!HTMLElement.prototype.click) {
  HTMLElement.prototype.click = function() {
    var ev = document.createEvent('MouseEvent');
    ev.initMouseEvent(
        'click',
        /*bubble*/true, /*cancelable*/true,
        window, null,
        0, 0, 0, 0, /*coordinates*/
        false, false, false, false, /*modifier keys*/
        0/*button=left*/, null
    );
    this.dispatchEvent(ev);
  };
}

// give ourselves a click function on SVG elements, courtesy of
// http://stackoverflow.com/a/28077816/528044
if (!SVGElement.prototype.click) {
  SVGElement.prototype.click = function() {
    var ev = document.createEvent('SVGEvents');
    ev.initEvent("click", true, true);
    this.dispatchEvent(ev);
  };
}

// phantomjs pre-2.0 has no Function.bind. simple polyfill courtesy of https://github.com/ariya/phantomjs/issues/10522#issuecomment-66449127
Function.prototype.bind = Function.prototype.bind || function (thisp) {
    var fn = this;
    return function () {
        return fn.apply(thisp, arguments);
    };
};
</script>

<script>
var boardElementTest = document.querySelector(".tenuki-board");
var gameTest = window.gameTest = new tenuki.Game(boardElementTest);
gameTest.setup();

resetTests = window.resetTests = function() {
  var _ref = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

  var boardSize = _ref.boardSize;
  var handicapStones = _ref.handicapStones;
  var scoring = _ref.scoring;
  var koRule = _ref.koRule;

  boardElementTest.innerHTML = "";
  gameTest = new tenuki.Game(boardElementTest);
  gameTest.setup({
    boardSize: boardSize || 19,
    handicapStones: handicapStones || 0,
    scoring: scoring || "territory",
    koRule: koRule || "simple"
  });
};

// black and white alternate
resetTests();

gameTest.renderer.grid.forEach(function(row) {
  row.forEach(function(pointElement) {
    if (!tenuki.utils.hasClass(pointElement, "empty")) {
      throw "tests failed";
    }
  })
});

gameTest.renderer.grid[5][5].click(); // b
gameTest.renderer.grid[5][6].click(); // w
gameTest.renderer.grid[5][7].click(); // b
gameTest.renderer.grid[5][8].click(); // w
gameTest.renderer.grid[5][9].click(); // b

if (!tenuki.utils.hasClass(gameTest.renderer.grid[5][5], "black")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[5][6], "white")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[5][7], "black")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[5][8], "white")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[5][9], "black")) {
  throw "tests failed";
}

// marker indicator
resetTests();

if (boardElementTest.querySelectorAll(".played").length != 0) {
  throw "tests failed";
}

gameTest.renderer.grid[1][1].click();
if (boardElementTest.querySelectorAll(".played").length == 0 || !tenuki.utils.hasClass(gameTest.renderer.grid[1][1], "played")) {
  throw "tests failed";
}

gameTest.renderer.grid[2][2].click();
if (boardElementTest.querySelectorAll(".played").length == 0 || tenuki.utils.hasClass(gameTest.renderer.grid[1][1], "played") || !tenuki.utils.hasClass(gameTest.renderer.grid[2][2], "played")) {
  throw "tests failed";
}

// multi-stone group capture
resetTests();

gameTest.renderer.grid[0][0].click(); // b
gameTest.renderer.grid[0][1].click(); // w
gameTest.renderer.grid[1][0].click(); // b
gameTest.renderer.grid[1][1].click(); // w
gameTest.renderer.grid[5][5].click(); // b tenuki
gameTest.renderer.grid[2][0].click(); // w

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][0], "empty")) {
  throw "tests failed";
}

if (!tenuki.utils.hasClass(gameTest.renderer.grid[1][0], "empty")) {
  throw "tests failed";
}

// undo should properly forget the undone move
resetTests();

gameTest.renderer.grid[0][0].click(); // b
gameTest.renderer.grid[0][1].click(); // w
gameTest.undo();
gameTest.renderer.grid[0][2].click(); // w

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][1], "empty")) {
  throw "tests failed";
}

// simple ko
resetTests();

gameTest.renderer.grid[3][3].click(); // b
gameTest.renderer.grid[3][2].click(); // w
gameTest.renderer.grid[4][2].click(); // b
gameTest.renderer.grid[4][1].click(); // w
gameTest.renderer.grid[5][3].click(); // b
gameTest.renderer.grid[5][2].click(); // w
gameTest.renderer.grid[4][4].click(); // b
gameTest.renderer.grid[4][3].click(); // w

if (!tenuki.utils.hasClass(gameTest.renderer.grid[4][2], "empty") || !tenuki.utils.hasClass(gameTest.renderer.grid[4][2], "ko")) {
  throw "tests failed";
}

if (!gameTest.isBlackPlaying()) {
  throw "tests failed";
}

gameTest.renderer.grid[4][2].click();

if (!tenuki.utils.hasClass(gameTest.renderer.grid[4][2], "empty") || !tenuki.utils.hasClass(gameTest.renderer.grid[4][2], "ko")) {
  throw "tests failed";
}

if (!gameTest.isBlackPlaying()) {
  throw "tests failed";
}

gameTest.renderer.grid[10][10].click();

if (!tenuki.utils.hasClass(gameTest.renderer.grid[4][2], "empty")) {
  throw "tests failed";
}

if (tenuki.utils.hasClass(gameTest.renderer.grid[4][2], "ko")) {
  throw "tests failed";
}

if (!gameTest.isWhitePlaying()) {
  throw "tests failed";
}

gameTest.renderer.grid[4][2].click();

if (!tenuki.utils.hasClass(gameTest.renderer.grid[4][2], "white")) {
  throw "tests failed";
}

// corner, ko, undo
resetTests();

gameTest.renderer.grid[0][0].click(); // b
gameTest.renderer.grid[0][1].click(); // w
gameTest.renderer.grid[1][1].click(); // b
gameTest.renderer.grid[1][0].click(); // w
gameTest.renderer.grid[0][2].click(); // b
gameTest.renderer.grid[1][2].click(); // w
gameTest.renderer.grid[0][0].click(); // b

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][1], "empty") || !tenuki.utils.hasClass(gameTest.renderer.grid[0][1], "ko")) {
  throw "tests failed";
}

gameTest.undo();

// verify ko gets undone
if (tenuki.utils.hasClass(gameTest.renderer.grid[0][1], "ko")) {
  throw "tests failed";
}

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][0], "empty")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][1], "white")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][2], "black")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[1][0], "white")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[1][1], "black")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[1][2], "white")) {
  throw "tests failed";
}

// passing removes a ko
resetTests();

gameTest.renderer.grid[0][0].click(); // b
gameTest.renderer.grid[0][1].click(); // w
gameTest.renderer.grid[1][1].click(); // b
gameTest.renderer.grid[1][0].click(); // w
gameTest.renderer.grid[0][2].click(); // b
gameTest.renderer.grid[1][2].click(); // w
gameTest.renderer.grid[0][0].click(); // b

gameTest.pass();

if (tenuki.utils.hasClass(gameTest.renderer.grid[0][1], "ko")) {
  throw "tests failed";
}

// no suicide in the corner
resetTests();

gameTest.renderer.grid[0][1].click(); // b
gameTest.renderer.grid[0][2].click(); // w
gameTest.renderer.grid[1][0].click(); // b
gameTest.renderer.grid[2][0].click(); // w
gameTest.renderer.grid[15][15].click(); // b tenuki
gameTest.renderer.grid[1][1].click(); // w

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][0], "empty")) {
  throw "tests failed";
}
gameTest.renderer.grid[0][0].click();
if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][0], "empty")) {
  throw "tests failed";
}

if (!gameTest.isBlackPlaying()) {
  throw "tests failed";
}

gameTest.renderer.grid[9][9].click(); // b tenuki
gameTest.renderer.grid[0][0].click();

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][0], "white")) {
  throw "tests failed";
}

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][1], "empty")) {
  throw "tests failed";
}
if (!tenuki.utils.hasClass(gameTest.renderer.grid[1][0], "empty")) {
  throw "tests failed";
}

// equivalence scoring white-passes-last rule
resetTests({ scoring: "equivalence" });

gameTest.pass(); // b
gameTest.pass(); // w

if (!gameTest.isOver()) {
  throw "tests failed";
}

gameTest.undo();
gameTest.undo();

gameTest.renderer.grid[1][1].click(); // b
gameTest.pass(); // w
gameTest.pass(); // b

if (gameTest.isOver()) {
  throw "tests failed";
}

gameTest.pass();

if (!gameTest.isOver()) {
  throw "tests failed";
}

// Scoring, with captures and dead stone marking
["area", "territory", "equivalence"].forEach(function(scoring) {
  resetTests({ handicapStones: 0, scoring: scoring });

  // divide the board down the middle, black on the right
  gameTest.renderer.grid[0][9].click(); // b
  gameTest.renderer.grid[0][8].click(); // w
  gameTest.renderer.grid[1][9].click(); // b
  gameTest.renderer.grid[1][8].click(); // w
  gameTest.renderer.grid[2][9].click(); // b
  gameTest.renderer.grid[2][8].click(); // w
  gameTest.renderer.grid[3][9].click(); // b
  gameTest.renderer.grid[3][8].click(); // w
  gameTest.renderer.grid[4][9].click(); // b
  gameTest.renderer.grid[4][8].click(); // w
  gameTest.renderer.grid[5][9].click(); // b
  gameTest.renderer.grid[5][8].click(); // w
  gameTest.renderer.grid[6][9].click(); // b
  gameTest.renderer.grid[6][8].click(); // w
  gameTest.renderer.grid[7][9].click(); // b
  gameTest.renderer.grid[7][8].click(); // w
  gameTest.renderer.grid[8][9].click(); // b
  gameTest.renderer.grid[8][8].click(); // w
  gameTest.renderer.grid[9][9].click(); // b
  gameTest.renderer.grid[9][8].click(); // w
  gameTest.renderer.grid[10][9].click(); // b
  gameTest.renderer.grid[10][8].click(); // w
  gameTest.renderer.grid[11][9].click(); // b
  gameTest.renderer.grid[11][8].click(); // w
  gameTest.renderer.grid[12][9].click(); // b
  gameTest.renderer.grid[12][8].click(); // w
  gameTest.renderer.grid[13][9].click(); // b
  gameTest.renderer.grid[13][8].click(); // w
  gameTest.renderer.grid[14][9].click(); // b
  gameTest.renderer.grid[14][8].click(); // w
  gameTest.renderer.grid[15][9].click(); // b
  gameTest.renderer.grid[15][8].click(); // w
  gameTest.renderer.grid[16][9].click(); // b
  gameTest.renderer.grid[16][8].click(); // w
  gameTest.renderer.grid[17][9].click(); // b
  gameTest.renderer.grid[17][8].click(); // w
  gameTest.renderer.grid[18][9].click(); // b
  gameTest.renderer.grid[18][8].click(); // w
  gameTest.pass(); // b
  gameTest.pass(); // w

  if (!gameTest.isOver()) {
    throw "tests failed";
  }

  var expectedScore;
  expectedScore = {
    territory: { black: 9*19, white: 8*19 },
    area: { black: 10*19, white: 9*19 },
    equivalence: { black: 10*19 + 1, white: 9*19 + 1 }
  };

  if (gameTest.score().black != expectedScore[scoring].black) {
    throw "tests failed";
  }

  if (gameTest.score().white != expectedScore[scoring].white) {
    throw "tests failed";
  }

  gameTest.undo();

  if (gameTest.isOver()) {
    throw "tests failed";
  }

  gameTest.undo();

  if (gameTest.currentState().blackStonesCaptured != 0 || gameTest.currentState().whiteStonesCaptured != 0) {
    throw "tests failed";
  }

  // play in the corner so white captures a stone and leaves 2 black stones dead
  gameTest.renderer.grid[0][0].click(); // b
  gameTest.renderer.grid[0][1].click(); // w
  gameTest.renderer.grid[1][1].click(); // b

  if (gameTest.currentState().blackStonesCaptured != 0 || gameTest.currentState().whiteStonesCaptured != 0) {
    throw "tests failed";
  }

  gameTest.renderer.grid[1][0].click(); // w

  if (gameTest.currentState().blackStonesCaptured != 1 || gameTest.currentState().whiteStonesCaptured != 0) {
    throw "tests failed";
  }

  gameTest.renderer.grid[0][2].click(); // b
  gameTest.pass(); // w
  gameTest.pass(); // b

  if (scoring === "equivalence") {
    gameTest.pass();
  }

  expectedScore = {
    territory: {
      // territory + captured stones, but with ambiguous territory remaining
      black: 9*19,
      // 1 captured stone
      // note the top-left corner is ignored as part of neutral point filling
      // for seki calculations
      white: 1
    },
    area: {
      // territory + stones on the board
      black: 10*19 + 2,
      // 1 point of territory + 2 stones played inside
      white: 1 + 1*19 + 2
    },
    equivalence: {
      // territory + stones on the board + 2 pass stones
      black: 10*19 + 2 + 2,
      // 1 point of territory + 2 stones played inside + 1 pass stone
      white: 1 + 1*19 + 2 + 1
    }
  };

  if (gameTest.score().black != expectedScore[scoring].black) {
    throw "tests failed";
  }

  if (gameTest.score().white != expectedScore[scoring].white) {
    throw "tests failed";
  }

  // mark dead stones
  gameTest.renderer.grid[1][1].click();
  gameTest.renderer.grid[0][2].click();

  if (!tenuki.utils.hasClass(gameTest.renderer.grid[1][1], "dead") || !tenuki.utils.hasClass(gameTest.renderer.grid[0][2], "dead")) {
    throw "tests failed";
  }

  expectedScore = {
    territory: {
      black: 9*19,
      // rectangle territory, 8*19
      // 2 white stones played inside the territory, -2
      // 1 captured black stone, +1,
      // 2 dead stones, +2
      white: 8*19 - 2 + 1 + 2
    },
    area: {
      // 2 dead stones are now ignored because they're marked dead
      black: 10*19,
      // rectangle territory, 8*19
      // plus 1*19 for the stones on the board
      // 2 white stones played inside the territory, IGNORED
      // 1 captured black stone, IGNORED
      // 2 dead stones, IGNORED
      white: 9*19
    },
    equivalence: {
      // 2 dead stones are now ignored because they're marked dead
      // plus 2 pass stones
      black: 10*19 + 2,
      // rectangle territory, 8*19
      // plus 1*19 for the stones on the board
      // 2 white stones played inside the territory, IGNORED
      // 1 captured black stone, IGNORED
      // 2 dead stones, IGNORED
      // 1 pass stone
      white: 9*19 + 1
    }
  };

  if (gameTest.score().black != expectedScore[scoring].black) {
    throw "tests failed";
  }

  if (gameTest.score().white != expectedScore[scoring].white) {
    throw "tests failed";
  }

  gameTest.undo();
  gameTest.undo();
  gameTest.undo();
  gameTest.undo();

  if (scoring === "equivalence") {
    gameTest.undo();
  }

  if (gameTest.currentState().blackStonesCaptured != 0 || gameTest.currentState().whiteStonesCaptured != 0) {
    throw "tests failed";
  }
});

// marking multi-stone groups as dead, and then toggling it
resetTests();

gameTest.renderer.grid[0][9].click(); // b
gameTest.renderer.grid[0][8].click(); // w
gameTest.renderer.grid[1][9].click(); // b
gameTest.pass();
gameTest.pass();

gameTest.renderer.grid[0][9].click(); // mark the 2-stone black group as dead

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][9], "dead") || !tenuki.utils.hasClass(gameTest.renderer.grid[1][9], "dead")) {
  throw "tests failed";
}

gameTest.renderer.grid[0][9].click(); // unmark it dead

if (tenuki.utils.hasClass(gameTest.renderer.grid[0][9], "dead") || tenuki.utils.hasClass(gameTest.renderer.grid[1][9], "dead")) {
  throw "tests failed";
}

// contrived territory marking case where two stones are alive on the board with nothing else
// which should lead to no territory marked
resetTests();

gameTest.renderer.grid[0][9].click(); // b
gameTest.renderer.grid[0][10].click(); // w
gameTest.pass();
gameTest.pass();

if (boardElementTest.querySelectorAll(".territory-black").length + boardElementTest.querySelectorAll(".territory-white").length > 0) {
  throw "tests failed";
}

// capturing a group with a stone that is a shared liberty
resetTests();
gameTest.renderer.grid[0][1].click(); // b
gameTest.renderer.grid[0][2].click(); // w
gameTest.renderer.grid[1][1].click(); // b
gameTest.renderer.grid[1][2].click(); // w
gameTest.renderer.grid[1][0].click(); // b
gameTest.renderer.grid[2][1].click(); // w
gameTest.renderer.grid[2][2].click(); // b
gameTest.renderer.grid[2][0].click(); // w
gameTest.renderer.grid[3][3].click(); // b
gameTest.renderer.grid[0][0].click(); // w

if (gameTest.currentState().blackStonesCaptured != 3 || gameTest.currentState().whiteStonesCaptured != 0) {
  throw "tests failed";
}

// handicap placement
resetTests({ handicapStones: 6 });

if (gameTest.currentPlayer() != "white") {
  throw "tests failed";
}

[
  [3, 3],
  [9, 3],
  [15, 3],
  [3, 15],
  [9, 15],
  [15, 15]
].forEach(function(el) {
  if (!tenuki.utils.hasClass(gameTest.renderer.grid[el[0]][el[1]], "black")) {
    throw "tests failed";
  }
});

resetTests({ handicapStones: 9 });

if (gameTest.currentPlayer() != "white") {
  throw "tests failed";
}

[
  [3, 3],
  [9, 3],
  [15, 3],
  [9, 3],
  [9, 9],
  [9, 15],
  [3, 15],
  [9, 15],
  [15, 15]
].forEach(function(el) {
  if (!tenuki.utils.hasClass(gameTest.renderer.grid[el[0]][el[1]], "black")) {
    throw "tests failed";
  }
});

// handicap stones count towards area
[
  { scoring: "territory", handicap: 5, initialScore: { white: 0, black: 361 - 5 }, expectedScore: { white: 0, black: 0 } },
  { scoring: "area", handicap: 5, initialScore: { white: 0, black: 361 }, expectedScore: { white: 2, black: 1+5 } },
  { scoring: "equivalence", handicap: 5, initialScore: { white: 1, black: 361+2 }, expectedScore: { white: 2+2, black: 1+5+2 } }
].forEach(function(test) {
  resetTests({ handicapStones: test["handicap"], scoring: test["scoring"] });

  gameTest.pass(); // w
  gameTest.pass(); // b

  if (test["scoring"] === "equivalence") {
    gameTest.pass(); // w
  }

  if (gameTest.score().white != test["initialScore"]["white"]) {
    throw "tests failed";
  }

  if (gameTest.score().black != test["initialScore"]["black"]) {
    throw "tests failed";
  }

  gameTest.undo();
  gameTest.undo();

  if (test["scoring"] === "equivalence") {
    gameTest.undo();
  }

  gameTest.renderer.grid[1][1].click(); // w
  gameTest.pass(); // b
  gameTest.renderer.grid[1][2].click(); // w
  gameTest.renderer.grid[1][3].click(); // b

  gameTest.pass(); // w
  gameTest.pass(); // b

  if (test["scoring"] === "equivalence") {
    gameTest.pass(); // w
  }

  if (gameTest.score().white != test["expectedScore"]["white"]) {
    throw "tests failed";
  }

  if (gameTest.score().black != test["expectedScore"]["black"]) {
    throw "tests failed";
  }
});

// seki scoring with eyes, with and without dead stones
resetTests({ handicapStones: 0, scoring: "territory" });

gameTest.renderer.grid[0][1].click() // b
gameTest.renderer.grid[0][2].click() // w
gameTest.renderer.grid[1][0].click() // b
gameTest.renderer.grid[1][2].click() // w
gameTest.renderer.grid[0][5].click() // b
gameTest.renderer.grid[1][3].click() // w
gameTest.renderer.grid[1][5].click() // b
gameTest.renderer.grid[1][4].click() // w
gameTest.renderer.grid[2][5].click() // b
gameTest.renderer.grid[0][4].click() // w
gameTest.renderer.grid[2][4].click() // b
gameTest.renderer.grid[2][2].click() // w
gameTest.renderer.grid[2][3].click() // b
gameTest.renderer.grid[2][1].click() // w
gameTest.renderer.grid[3][3].click() // b
gameTest.renderer.grid[2][0].click() // w
gameTest.renderer.grid[3][2].click() // b
gameTest.renderer.grid[10][10].click() // w
gameTest.renderer.grid[3][1].click() // b
gameTest.renderer.grid[10][11].click() // w
gameTest.renderer.grid[3][0].click() // b

gameTest.pass();
gameTest.pass();

if (boardElementTest.querySelectorAll(".territory-black").length + boardElementTest.querySelectorAll(".territory-white").length > 0) {
  throw "tests failed";
}

if (gameTest.score().black > 0 || gameTest.score().white > 0) {
  throw "tests failed";
}

gameTest.renderer.grid[2][2].click(); // mark seki white group dead

if (gameTest.score().black != 11 + 8 || gameTest.score().white != 0) {
  throw "tests failed";
}

gameTest.renderer.grid[10][10].click(); // mark the outer white group dead

if (boardElementTest.querySelectorAll(".territory-white").length + gameTest.score().white > 0) {
  throw "test failed";
}

// 8 dead white stones double-counted as territory + 3 empty points
// + 2 outer dead stones double-counted as territory + all remaining empty points
if (boardElementTest.querySelectorAll(".territory-black").length != 8 + 3 + 2 + 337) {
  throw "tests failed";
}

if (gameTest.score().black != 8*2 + 3 + 2*2 + 337) {
  throw "tests failed";
}

// unmark white dead
gameTest.renderer.grid[2][2].click();
gameTest.renderer.grid[10][10].click();

if (boardElementTest.querySelectorAll(".territory-black").length + boardElementTest.querySelectorAll(".territory-white").length > 0) {
  throw "tests failed";
}

if (gameTest.score().black > 0 || gameTest.score().white > 0) {
  throw "tests failed";
}

// mark both black stones dead
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[1][0].click();

if (boardElementTest.querySelectorAll(".territory-black").length + gameTest.score().black > 0) {
  throw "test failed";
}

// 2 dead black stones double-counted as territory + 3 empty points
if (boardElementTest.querySelectorAll(".territory-white").length != 2 + 3) {
  throw "tests failed";
}

if (gameTest.score().white != 2*2 + 3) {
  throw "tests failed";
}

// seki with a false eye
resetTests();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[0][4].click();
gameTest.renderer.grid[0][3].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[3][2].click();
gameTest.renderer.grid[2][2].click();
gameTest.renderer.grid[4][1].click();
gameTest.renderer.grid[3][1].click();
gameTest.renderer.grid[4][0].click();
gameTest.renderer.grid[3][0].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 342 || gameTest.score().white != 0) {
  throw "tests failed";
}

// seki with two false eyes
resetTests();

gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[0][4].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[2][4].click();
gameTest.renderer.grid[0][3].click();
gameTest.renderer.grid[3][3].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[3][5].click();
gameTest.renderer.grid[3][2].click();
gameTest.renderer.grid[4][3].click();
gameTest.renderer.grid[3][1].click();
gameTest.renderer.grid[4][2].click();
gameTest.renderer.grid[3][0].click();
gameTest.renderer.grid[4][1].click();
gameTest.pass();
gameTest.renderer.grid[4][0].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().white != 0) {
  throw "tests failed";
}

// seki with two 1-eyed groups
resetTests({ handicapStones: 0, scoring: "territory", boardSize: 9 });

gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[2][0].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[2][2].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[0][3].click();
gameTest.renderer.grid[2][4].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[2][6].click();
gameTest.renderer.grid[0][5].click();
gameTest.renderer.grid[1][6].click();
gameTest.pass();
gameTest.renderer.grid[0][6].click();
gameTest.renderer.grid[3][2].click();
gameTest.renderer.grid[1][7].click();
gameTest.renderer.grid[4][2].click();
gameTest.renderer.grid[0][8].click();
gameTest.renderer.grid[4][1].click();
gameTest.renderer.grid[2][8].click();
gameTest.renderer.grid[5][1].click();
gameTest.renderer.grid[3][3].click();
gameTest.renderer.grid[5][0].click();
gameTest.renderer.grid[4][3].click();
gameTest.renderer.grid[3][0].click();
gameTest.renderer.grid[5][3].click();
gameTest.pass();
gameTest.renderer.grid[5][2].click();
gameTest.pass();
gameTest.renderer.grid[6][2].click();
gameTest.pass();
gameTest.renderer.grid[6][1].click();
gameTest.pass();
gameTest.renderer.grid[6][0].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().white != 2 || gameTest.score().black != 42) {
  throw "tests failed";
}

// not-a-seki because territories should merge properly across "thick"
// boundaries.
resetTests();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[2][0].click();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[2][2].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[0][2].click();
gameTest.renderer.grid[2][4].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[0][4].click();
gameTest.renderer.grid[0][5].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 2 || gameTest.score().white != 343) {
  throw "tests failed";
}

// false-looking eyes in groups that are alive after filling those
// false-looking points, are _not_ ignored
resetTests();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[2][2].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[0][3].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[2][0].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[2][4].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[0][5].click();
gameTest.renderer.grid[2][6].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[2][7].click();
gameTest.renderer.grid[1][7].click();
gameTest.renderer.grid[2][8].click();
gameTest.renderer.grid[0][7].click();
gameTest.renderer.grid[1][8].click();
gameTest.pass()
gameTest.renderer.grid[0][8].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 4) {
  throw "tests failed";
}

// false eyes that should be filled in under correct play
// are not ignored if the sequence is not sufficiently played out.
resetTests();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[2][0].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[2][2].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[0][3].click();
gameTest.renderer.grid[2][4].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[2][6].click();
gameTest.renderer.grid[0][6].click();
gameTest.renderer.grid[1][7].click();
gameTest.pass();
gameTest.renderer.grid[0][7].click();
gameTest.pass();
gameTest.renderer.grid[2][7].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 4) {
  throw "tests failed";
}

// false eyes that will disappear due to direct
// atari after filling neutral points should be
// ignored, which can affect the status of live groups.
resetTests();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[0][2].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[0][5].click();
gameTest.renderer.grid[2][4].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[1][7].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[0][8].click();
gameTest.renderer.grid[2][6].click();
gameTest.renderer.grid[1][9].click();
gameTest.renderer.grid[2][7].click();
gameTest.renderer.grid[1][10].click();
gameTest.renderer.grid[2][8].click();
gameTest.renderer.grid[0][11].click();
gameTest.renderer.grid[1][8].click();
gameTest.renderer.grid[1][12].click();
gameTest.renderer.grid[2][9].click();
gameTest.pass();
gameTest.renderer.grid[2][10].click();
gameTest.pass();
gameTest.renderer.grid[2][11].click();
gameTest.pass();
gameTest.renderer.grid[1][11].click();
gameTest.pass();
gameTest.renderer.grid[2][12].click();
gameTest.pass();
gameTest.renderer.grid[2][13].click();
gameTest.pass();
gameTest.renderer.grid[1][13].click();
gameTest.pass();
gameTest.renderer.grid[0][13].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 0) {
  throw "tests failed";
}

// false eyes that are the last remaining points after filling dame:
// ignored as territory.
resetTests();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[0][2].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[2][4].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[1][7].click();
gameTest.renderer.grid[2][6].click();
gameTest.renderer.grid[1][8].click();
gameTest.renderer.grid[2][7].click();
gameTest.renderer.grid[1][9].click();
gameTest.renderer.grid[2][8].click();
gameTest.renderer.grid[0][9].click();
gameTest.renderer.grid[2][9].click();
gameTest.renderer.grid[0][7].click();
gameTest.renderer.grid[2][10].click();
gameTest.renderer.grid[0][5].click();
gameTest.renderer.grid[1][10].click();
gameTest.pass();
gameTest.renderer.grid[0][10].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 3) {
  throw "tests failed";
}

// false eyes in the corner are also correctly ignored
resetTests({ handicapStones: 0, scoring: "territory", boardSize: 9 });

gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[2][0].click();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[2][2].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[1][4].click();
gameTest.renderer.grid[2][4].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[2][6].click();
gameTest.renderer.grid[1][7].click();
gameTest.renderer.grid[2][7].click();
gameTest.renderer.grid[1][8].click();
gameTest.renderer.grid[2][8].click();
gameTest.renderer.grid[0][7].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[0][4].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 4) {
  throw "tests failed";
}

// eyepoints separated by bamboo-type connections
resetTests();

gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[0][0].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[2][0].click();
gameTest.renderer.grid[3][1].click();
gameTest.renderer.grid[3][0].click();
gameTest.renderer.grid[3][2].click();
gameTest.renderer.grid[4][0].click();
gameTest.renderer.grid[3][3].click();
gameTest.renderer.grid[4][1].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[4][2].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[4][3].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[4][4].click();
gameTest.renderer.grid[3][5].click();
gameTest.renderer.grid[4][5].click();
gameTest.renderer.grid[3][6].click();
gameTest.renderer.grid[4][6].click();
gameTest.renderer.grid[3][7].click();
gameTest.renderer.grid[4][7].click();
gameTest.renderer.grid[2][7].click();
gameTest.renderer.grid[4][8].click();
gameTest.renderer.grid[1][7].click();
gameTest.renderer.grid[3][8].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[2][8].click();
gameTest.pass();
gameTest.renderer.grid[1][8].click();
gameTest.pass();
gameTest.renderer.grid[0][8].click();
gameTest.pass();
gameTest.renderer.grid[0][7].click();
gameTest.pass();
gameTest.renderer.grid[0][6].click();
gameTest.pass();
gameTest.renderer.grid[0][5].click();
gameTest.pass();
gameTest.renderer.grid[0][4].click();
gameTest.pass();
gameTest.renderer.grid[0][3].click();
gameTest.pass();
gameTest.renderer.grid[0][2].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 2) {
  throw "tests failed";
}

resetTests();

gameTest.pass();

gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[0][1].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[0][0].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[1][0].click();
gameTest.renderer.grid[1][3].click();
gameTest.renderer.grid[2][0].click();
gameTest.renderer.grid[3][1].click();
gameTest.renderer.grid[3][0].click();
gameTest.renderer.grid[3][2].click();
gameTest.renderer.grid[4][0].click();
gameTest.renderer.grid[3][3].click();
gameTest.renderer.grid[4][1].click();
gameTest.renderer.grid[2][3].click();
gameTest.renderer.grid[4][2].click();
gameTest.renderer.grid[1][5].click();
gameTest.renderer.grid[4][3].click();
gameTest.renderer.grid[2][5].click();
gameTest.renderer.grid[4][4].click();
gameTest.renderer.grid[3][5].click();
gameTest.renderer.grid[4][5].click();
gameTest.renderer.grid[3][6].click();
gameTest.renderer.grid[4][6].click();
gameTest.renderer.grid[3][7].click();
gameTest.renderer.grid[4][7].click();
gameTest.renderer.grid[2][7].click();
gameTest.renderer.grid[4][8].click();
gameTest.renderer.grid[1][7].click();
gameTest.renderer.grid[3][8].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[2][8].click();
gameTest.pass();
gameTest.renderer.grid[1][8].click();
gameTest.pass();
gameTest.renderer.grid[0][8].click();
gameTest.pass();
gameTest.renderer.grid[0][7].click();
gameTest.pass();
gameTest.renderer.grid[0][6].click();
gameTest.pass();
gameTest.renderer.grid[0][5].click();
gameTest.pass();
gameTest.renderer.grid[0][4].click();
gameTest.pass();
gameTest.renderer.grid[0][3].click();
gameTest.pass();
gameTest.renderer.grid[0][2].click();
gameTest.pass();
gameTest.pass();

if (gameTest.score().white != 2) {
  throw "tests failed";
}

// seki with two 1-eyed groups that can't connect out
// to live groups.
resetTests({ handicapStones: 0, scoring: "territory", boardSize: 9 });

gameTest.renderer.grid[8][0].click();
gameTest.renderer.grid[8][2].click();
gameTest.renderer.grid[8][1].click();
gameTest.renderer.grid[8][3].click();
gameTest.renderer.grid[7][1].click();
gameTest.renderer.grid[7][3].click();
gameTest.renderer.grid[6][1].click();
gameTest.renderer.grid[6][3].click();
gameTest.renderer.grid[6][0].click();
gameTest.renderer.grid[6][4].click();
gameTest.renderer.grid[6][2].click();
gameTest.renderer.grid[6][5].click();
gameTest.renderer.grid[8][6].click();
gameTest.renderer.grid[7][5].click();
gameTest.renderer.grid[8][7].click();
gameTest.renderer.grid[8][5].click();
gameTest.renderer.grid[6][6].click();
gameTest.renderer.grid[8][8].click();
gameTest.renderer.grid[6][7].click();
gameTest.renderer.grid[7][8].click();
gameTest.renderer.grid[5][6].click();
gameTest.renderer.grid[8][4].click();
gameTest.renderer.grid[5][5].click();
gameTest.renderer.grid[6][8].click();
gameTest.renderer.grid[5][4].click();
gameTest.renderer.grid[5][8].click();
gameTest.renderer.grid[5][3].click();
gameTest.renderer.grid[5][2].click();
gameTest.renderer.grid[4][3].click();
gameTest.renderer.grid[4][2].click();
gameTest.renderer.grid[3][3].click();
gameTest.renderer.grid[5][0].click();
gameTest.renderer.grid[3][2].click();
gameTest.renderer.grid[4][0].click();
gameTest.renderer.grid[3][1].click();
gameTest.renderer.grid[3][0].click();
gameTest.pass();
gameTest.renderer.grid[2][0].click();
gameTest.pass();
gameTest.renderer.grid[4][8].click();
gameTest.pass();
gameTest.renderer.grid[4][7].click();
gameTest.pass();
gameTest.renderer.grid[3][7].click();
gameTest.pass();
gameTest.renderer.grid[2][7].click();
gameTest.pass();
gameTest.renderer.grid[1][7].click();
gameTest.pass();
gameTest.renderer.grid[0][7].click();
gameTest.pass();
gameTest.renderer.grid[1][8].click();
gameTest.renderer.grid[4][6].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[3][6].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[2][6].click();
gameTest.renderer.grid[0][0].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[0][2].click();
gameTest.renderer.grid[0][6].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[2][3].click();
gameTest.pass();
gameTest.renderer.grid[1][3].click();
gameTest.pass();
gameTest.renderer.grid[0][3].click();
gameTest.renderer.grid[5][7].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().black != 10 || gameTest.score().white != 5) {
  throw "tests failed";
}



resetTests({ handicapStones: 0, scoring: "territory", boardSize: 9 });

gameTest.pass();

gameTest.renderer.grid[8][0].click();
gameTest.renderer.grid[8][2].click();
gameTest.renderer.grid[8][1].click();
gameTest.renderer.grid[8][3].click();
gameTest.renderer.grid[7][1].click();
gameTest.renderer.grid[7][3].click();
gameTest.renderer.grid[6][1].click();
gameTest.renderer.grid[6][3].click();
gameTest.renderer.grid[6][0].click();
gameTest.renderer.grid[6][4].click();
gameTest.renderer.grid[6][2].click();
gameTest.renderer.grid[6][5].click();
gameTest.renderer.grid[8][6].click();
gameTest.renderer.grid[7][5].click();
gameTest.renderer.grid[8][7].click();
gameTest.renderer.grid[8][5].click();
gameTest.renderer.grid[6][6].click();
gameTest.renderer.grid[8][8].click();
gameTest.renderer.grid[6][7].click();
gameTest.renderer.grid[7][8].click();
gameTest.renderer.grid[5][6].click();
gameTest.renderer.grid[8][4].click();
gameTest.renderer.grid[5][5].click();
gameTest.renderer.grid[6][8].click();
gameTest.renderer.grid[5][4].click();
gameTest.renderer.grid[5][8].click();
gameTest.renderer.grid[5][3].click();
gameTest.renderer.grid[5][2].click();
gameTest.renderer.grid[4][3].click();
gameTest.renderer.grid[4][2].click();
gameTest.renderer.grid[3][3].click();
gameTest.renderer.grid[5][0].click();
gameTest.renderer.grid[3][2].click();
gameTest.renderer.grid[4][0].click();
gameTest.renderer.grid[3][1].click();
gameTest.renderer.grid[3][0].click();
gameTest.pass();
gameTest.renderer.grid[2][0].click();
gameTest.pass();
gameTest.renderer.grid[4][8].click();
gameTest.pass();
gameTest.renderer.grid[4][7].click();
gameTest.pass();
gameTest.renderer.grid[3][7].click();
gameTest.pass();
gameTest.renderer.grid[2][7].click();
gameTest.pass();
gameTest.renderer.grid[1][7].click();
gameTest.pass();
gameTest.renderer.grid[0][7].click();
gameTest.pass();
gameTest.renderer.grid[1][8].click();
gameTest.renderer.grid[4][6].click();
gameTest.renderer.grid[2][1].click();
gameTest.renderer.grid[3][6].click();
gameTest.renderer.grid[1][1].click();
gameTest.renderer.grid[2][6].click();
gameTest.renderer.grid[0][0].click();
gameTest.renderer.grid[1][6].click();
gameTest.renderer.grid[0][2].click();
gameTest.renderer.grid[0][6].click();
gameTest.renderer.grid[1][2].click();
gameTest.renderer.grid[2][3].click();
gameTest.pass();
gameTest.renderer.grid[1][3].click();
gameTest.pass();
gameTest.renderer.grid[0][3].click();
gameTest.renderer.grid[5][7].click();

gameTest.pass();
gameTest.pass();

if (gameTest.score().white != 10 || gameTest.score().black != 5) {
  throw "tests failed";
}

// superko
resetTests({ koRule: "superko" });

// cycle for ● repeatedly losing 2 stones
// ┌─●─┬─○─●
// ●─○─○─○─●
// ●─┼─○─●─●
// ○─○─○─●─┼
// ●─●─●─●─┼

gameTest.renderer.grid[0][3].click(); // b
gameTest.renderer.grid[0][4].click(); // w
gameTest.renderer.grid[1][3].click(); // b
gameTest.renderer.grid[1][4].click(); // w
gameTest.renderer.grid[1][2].click(); // b
gameTest.renderer.grid[2][4].click(); // w
gameTest.renderer.grid[1][1].click(); // b
gameTest.renderer.grid[2][3].click(); // w
gameTest.renderer.grid[2][2].click(); // b
gameTest.renderer.grid[3][3].click(); // w
gameTest.renderer.grid[3][2].click(); // b
gameTest.renderer.grid[4][3].click(); // w
gameTest.renderer.grid[3][1].click(); // b
gameTest.renderer.grid[4][2].click(); // w
gameTest.renderer.grid[3][0].click(); // b
gameTest.renderer.grid[4][1].click(); // w
gameTest.renderer.grid[0][8].click(); // b
gameTest.renderer.grid[4][0].click(); // w
gameTest.renderer.grid[1][8].click(); // b
gameTest.renderer.grid[0][1].click(); // w
gameTest.renderer.grid[2][8].click(); // b
gameTest.renderer.grid[1][0].click(); // w
gameTest.renderer.grid[3][8].click(); // b
gameTest.renderer.grid[2][0].click(); // w
gameTest.renderer.grid[4][8].click(); // b -- (*)
gameTest.renderer.grid[0][2].click(); // w
gameTest.renderer.grid[0][0].click(); // b
gameTest.renderer.grid[0][1].click(); // w -- this move is not allowed with superko since it repeats (*)

if (!tenuki.utils.hasClass(gameTest.renderer.grid[0][1], "empty")) {
  throw "tests failed";
}

if (gameTest.currentPlayer() != "white") {
  throw "tests failed";
}

if (gameTest.currentState().playedPoint.y != 0 || gameTest.currentState().playedPoint.x != 0) {
  throw "tests failed";
}

// superko with a triple ko
resetTests({ koRule: "superko" });

// ko A
gameTest.renderer.grid[3][5].click(); // b
gameTest.renderer.grid[3][4].click(); // w
gameTest.renderer.grid[4][4].click(); // b
gameTest.renderer.grid[4][3].click(); // w
gameTest.renderer.grid[5][5].click(); // b
gameTest.renderer.grid[5][4].click(); // w
gameTest.renderer.grid[4][6].click(); // b
gameTest.renderer.grid[4][5].click(); // w

// ko B
gameTest.renderer.grid[3][10].click(); // b
gameTest.renderer.grid[3][9].click(); // w
gameTest.renderer.grid[4][9].click(); // b
gameTest.renderer.grid[4][8].click(); // w
gameTest.renderer.grid[5][10].click(); // b
gameTest.renderer.grid[5][9].click(); // w
gameTest.renderer.grid[4][11].click(); // b
gameTest.renderer.grid[4][10].click(); // w

// ko C
gameTest.renderer.grid[6][7].click(); // b
gameTest.renderer.grid[6][6].click(); // w
gameTest.renderer.grid[7][6].click(); // b
gameTest.renderer.grid[7][5].click(); // w
gameTest.renderer.grid[8][7].click(); // b
gameTest.renderer.grid[8][6].click(); // w
gameTest.renderer.grid[7][8].click(); // b
gameTest.renderer.grid[7][7].click(); // w (*)

// black capture ko A
gameTest.renderer.grid[4][4].click(); // b
// white tenuki
gameTest.renderer.grid[2][7].click(); // w

// 3 kos, clockwise: (A) black, (B) white, (C) white

gameTest.renderer.grid[4][9].click(); // b: ko B -> black
gameTest.renderer.grid[4][5].click(); // w: ko A -> white
gameTest.renderer.grid[7][6].click(); // b: ko C -> black
gameTest.renderer.grid[4][10].click(); // w: ko B -> white
gameTest.renderer.grid[4][4].click(); // b: ko A -> black

// kos are now: (A) black, (B) white, (C) black

gameTest.renderer.grid[7][7].click(); // not allowed, since it would change ko C to white, leading to a repetition of (*)

if (!tenuki.utils.hasClass(gameTest.renderer.grid[7][7], "empty")) {
  throw "tests failed";
}

if (gameTest.currentPlayer() != "white") {
  throw "tests failed";
}

if (gameTest.currentState().playedPoint.y != 4 || gameTest.currentState().playedPoint.x != 4) {
  throw "tests failed";
}

// fancy "pass" print
resetTests();
gameTest.renderer.grid[3][2].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][3].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][4].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][6].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][7].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][8].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][10].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][11].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][12].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][14].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][15].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[3][16].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[4][2].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[4][4].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[4][6].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[4][8].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[4][10].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[4][14].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][2].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][3].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][4].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][6].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][7].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][8].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][10].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][11].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][12].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][14].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][15].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[5][16].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[6][2].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[6][6].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[6][8].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[6][12].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[6][16].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][2].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][6].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][8].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][10].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][11].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][12].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][14].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][15].setAttribute("class", "intersection occupied stone black");
gameTest.renderer.grid[7][16].setAttribute("class", "intersection occupied stone black");
</script>
